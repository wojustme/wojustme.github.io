---
layout: post
title: "æ•°æ®åŒå‘ç»‘å®š"
date: "2017-02-28 19:27:24 +0800"
categories: JS
tags: JS
excerpt: JSä¸­çš„æ•°æ®åŒå‘ç»‘å®š
mathjax: true
---

# å®ç°åŒå‘æ•°æ®ç»‘å®šçš„å°å®è·µ
## æ–¹æ¡ˆ
> 1. å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å‹
> 2. è„å€¼æ£€æŸ¥æœºåˆ¶
> 3. æ•°æ®åŠ«æŒ

###  ç”±äºæœ€è¿‘åœ¨ä½¿ç”¨Vue2.0æ¡†æ¶ï¼Œæ‰€ä»¥å¯¹å…¶ä¸­çš„æ•°æ®ç»‘å®šæœºåˆ¶æ„Ÿå…´è¶£ã€‚
#### æœ€ç»ˆä½¿ç”¨Vueçš„æ•°æ®åŠ«æŒæœºåˆ¶æ¥å®ç°åŒå‘æ•°æ®ç»‘å®šåŠŸèƒ½
## æœ€ç»ˆå®ç°ç»“æœå¦‚ä¸‹
![image](../../../../public/img/æ•°æ®åŒå‘ç»‘å®š.gif)
## å®ç°æœºåˆ¶
- ### JavaScriptçš„ES5ç‰¹æ€§ä¸­,é’ˆå¯¹Objectæœ‰definePropertyæ–¹æ³•ã€‚ä½¿ç”¨å¦‚ä¸‹:
{% highlight JavaScript %}
  var obj = {}
  // key-->objä¸­çš„keyå€¼
  Object.defineProperty(obj, key, {
    value: , // åˆå§‹åŒ–å€¼
    writable: , // å¯å†™
    configurable: , // ä»»ä½•å¯¹å±æ€§å†™ã€åˆ ç­‰æ“ä½œï¼Œæ— æ•ˆ
    enumerable: , // åœ¨for-inä¸­æ˜¯å¦å¯ä»¥åˆ—ä¸¾å‡º
    get: () => {}, // è¯»æ“ä½œ
    set: (newVal) => {} // å†™æ“ä½œ
  })
{% endhighlight %}
#### åˆ™åŸºäºES5ä¸­definePropertyçš„ç‰¹æ€§ï¼Œç®€å•çš„åŒå‘ç»‘å®šï¼Œä»£ç å¦‚ä¸‹
{% highlight HTML %}
<div id="app">
  <input type="text" id="a">
  <span id="b"></span>
</div>
<script>
var obj = {};
Object.defineProperty(obj, '$data', {
  set: function(newVal) {
    document.getElementById('a').value = newVal;
    document.getElementById('b').innerHTML = newVal;
  }
});
document.addEventListener('keyup', function(e) {
  if (e.target.value) {
    obj.$data = e.target.value;
  } else {
    obj.$data = '';
  }
});
</script>
{% endhighlight %}
- ### JavaScriptçš„ES6æ–°å¢äº†ä¸€ä¸ªProxyç±»ï¼Œç”¨æ¥æ¥ç®¡é€šè¿‡Prxoyåˆ›å»ºçš„ä»£ç†å¯¹è±¡ã€‚ä½¿ç”¨å¦‚ä¸‹ï¼š
```
var obj = new Proxy(target, handler);
// å…¶ä¸­handlerå±æ€§ï¼Œå¦‚ä¸‹
1. get(target, propKey, receiver)
2. set(target, propKey, value, receiver)
3. has(target, propKey)
4. deleteProperty(target, propKey)
5. ownKeys(target)
6. getOwnPropertyDescriptor(target, propKey)
7. defineProperty(target, propKey, propDesc)
8. preventExtensions(target)
9. getPrototypeOf(target)
10.isExtensible(target)
11.setPrototypeOf(target, proto)
12.apply(target, object, args)
13.construct(target, args)
```

##### è¿™é‡Œè´´å‡ºä¸€ç¯‡ä½¿ç”¨æ–‡æ¡£ï¼Œæ¥è‡ª[é˜®å¤§å¤§](http://es6.ruanyifeng.com/#docs/proxy)

#### ä½¿ç”¨ES6çš„ä»£ç†ç‰¹æ€§å®ç°æ•°æ®åŒå‘ç»‘å®šï¼Œä»£ç å¦‚ä¸‹
{% highlight HTML %}
<div id="app">
  <input type="text" id="a">
  <span id="b"></span>
</div>
<script>
var obj = new Proxy({}, {
  get: function (target, key, receiver) {
    return Reflect.get(target, key, receiver);
  },
  set: function (target, key, value, receiver) {
    if (key === '$data') {
     document.getElementById('a').value = value;
     document.getElementById('b').innerHTML = value;
    }
    return Reflect.set(target, key, value, receiver);
  }
});
document.addEventListener('keyup', function(e) {
  if (e.target.value) {
    obj.$data = e.target.value;
  } else {
    obj.$data = '';
  }
});
</script>
{% endhighlight %}
å…¶ä¸­ï¼Œä½¿ç”¨äº†Reflectæ–°å¢ç±»ï¼Œä¹Ÿæ˜¯ES6æ–°å¢ï¼Œç”¨äºåå°„åˆ°åŸæœ‰çš„åŸç”Ÿé“¾ä¸­å»ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•å’Œä½¿ç”¨èŒƒå›´ï¼Œè¯·[å‚è€ƒ](http://es6.ruanyifeng.com/#docs/reflect)ã€‚

# **æœ€åå°æ€»ç»“ä¸€ä¸‹**
> ### ä¸ªäººå°è§è§£ï¼Œæ¬¢è¿è¡¥å……
- è¯¥æ•°æ®ç»‘å®šéƒ½æ˜¯åŸºäºä¸€ä¸ªç°æœ‰å¯¹è±¡objï¼Œé€šè¿‡JSçš„keyupçš„äº‹ä»¶ï¼Œæ¥ç›‘å¬objä¸­$dataå±æ€§ï¼Œä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œç«‹é©¬æ›´æ–°å¯¹åº”çš„DomèŠ‚ç‚¹ã€‚
- Vueå®ç°çš„æ•°æ®åŒå‘ç»‘å®šè‚¯å®šä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œæ¶‰åŠåˆ°æ¨¡æ¿æŒ‡ä»¤ã€è§‚å¯Ÿè€…ã€è®¢é˜…ç®¡é“å™¨ã€è™šæ‹ŸDOMå®ç°ç­‰ç­‰ã€‚å…·ä½“å®ç°ç½‘ä¸Šæœ‰å¾ˆå¤šä¾‹å­ï¼Œè¿™é‡Œåˆ—å‡ºä¸€ä¸ªåˆ«äººå®ç°ç®€å•çš„MVVMåŸç†çš„[GitHubé¡¹ç›®åœ°å€](https://github.com/wojustme/mvvm)ã€‚
- å†™è¿™ä¸ªæ–‡ç« ç›®çš„æ˜¯ä»‹ç»ä¸€ä¸‹ES6å¯ä»¥å¾ˆè½»æ¾çš„æ¥å®ç°æ•°æ®ç»‘å®šï¼Œå½“ç„¶ES5çš„definePropertyä¹ŸåŒæ ·å¾ˆæ–¹ä¾¿ã€‚ğŸ˜ğŸ˜ğŸ˜
- æœ¬äººæ˜¯å°ç å†œï¼Œä»€ä¹ˆæ–°æŠ€æœ¯éƒ½çˆ±ç©ã€‚éšæ—¶éªšæ‰°æˆ‘ã€‚ğŸ“§:xurenhe19910131@163.com
